{% extends "base.html" %}
{% block title %}{{ brand }}: twitter{% endblock %}
{% block navbar %} {% include "navbar.html" %} {% endblock %}

{% block content %}
<div class="container-narrow">

<div class="row-fluid hide" id="twitter_form">
<form class="form-inline" action="/twitter/tweet">
  <div class="control-group" id="input_tweet">
    <textarea name="text_tweet" id="text_tweet" rows="3" class="span9" placeholder="140 caratteri"></textarea>
    <button class="btn btn-large span3" type="submit" >tweet</button>
  </div>
  <script type="text/javascript">
  $('#text_tweet').keyup(function() {
    var len = this.value.length;
    if (len >= 140) {
      $('#input_tweet').removeClass('success');
      $('#input_tweet').addClass('error');
    } else {
      $('#input_tweet').addClass('success');
    }
  });
  </script>
</form>
</div>

<div class="row-fluid">
<table class="table table-condensed">
  <tbody>
    {% for tweet in tweets %}
    <tr class="hidden-desktop">
      <td> <b>{{tweet.user.screen_name }}</b>: {{tweet.text|urlize}} </td>
      <td> <a class="btn btn-mini" onclick="retweet('{{ tweet.id_str }}')"> <i class="icon-retweet"></i></a> </td>
    </tr>
    <tr class="visible-desktop">
      <td><img title="{{tweet.user.screen_name }}" src="{{tweet.user.profile_image_url }}" height="48" width="48"></td>
      <td> {{tweet.user.screen_name }} </td>
      <td class="tweet"> {{tweet.text|urlize}} </td>
      <td><a class="btn btn-mini" onclick="retweet('{{ tweet.id_str }}')"><i class="icon-retweet"></i></a></div></td>
    </tr>
    {% for media in tweet.entities.media %}
    <tr class="hidden-desktop"> <td colspan="2"> <img src="{{media.media_url}}"> </td> </tr>
    <tr class="visible-desktop"> <td colspan="2"></td> <td colspan="4"> <img src="{{media.media_url}}"> </td> </tr>
    {% endfor %}
    {% endfor %}
  </tbody>
</table>
</div>

</div>
<script type="text/javascript">
  $('.tweet a').attr('target', '_blank');
</script>
{% endblock %}
